{% extends "standbase/base.html" %}

{% block extrahead %}
  
  <script type="text/javascript">

    var active_sessions = {};
    active_sessions[{{ session.id }}] = {
      'datestart': new Date();
    }

    $(document).ready(function() {


      // Update seconds on all the active sessions
    });

    function updateCounters() {
      // Walk through all the active sessions and update the counters in #time_id
    }

    function checkForFinishedSessions() {
      // Once every minute poll to see if any sessions have finished
      // Will return an array of the sessions active right now

      // TODO also update the recently completed sessions
    }

  </script>

{% endblock %}

{% block content %}

<div class="starter-template">
  <h1>Standing</h1>
  <p class="lead bg-info">Standing is an app for ludic resistance. Go outside, find a public place, pick a cause and start standing.</p>
</div>

<div class="row">
  <div class="col-md-6">
    <h2>People standing right now</h2>
    <p>Locations where people are standing at this very moment.</p>

    {% if active_sessions %}
      <ol class="list-unstyled">
      {% for session in active_sessions %}
        <li>For <span id="time_{{ session.id }}">x seconds</span> near {{ session.lat }} &times; {{ session.lon }} ({{ session.nearest_available_area }})</li>
      {% endfor %}
      </ol>
    {% else %}
      <p>No sessions right now.</p>
    {% endif %}
  </div>

  <div class="col-md-6">
  <h2>Recently completed sessions</h2>
  <p>Sessions that have been completed recently including their duration and their reason.</p>
  {% if completed_sessions %}
  <ol class="list-unstyled">
  {% for session in completed_sessions %}
  <li><a href="{{ session.get_absolute_url }}">Somebody stood for {{ session.topic }} for {{ session.datefinished|timeuntil:session.datecreated }} at {{ session.lat }} &times; {{ session.lon }} some {{ session.datefinished|timesince }} ago</a></li>
  {% endfor %}
  </ol>
  {% endif %}
  </div>
</div>

{% endblock content %}